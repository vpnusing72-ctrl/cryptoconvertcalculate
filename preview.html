<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Crypto Converter | 2000+ Cryptocurrencies</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0052ff;
            --primary-light: #e8f0ff;
            --dark: #0a0b0d;
            --gray-dark: #1e2127;
            --gray: #5d6785;
            --gray-light: #a0a7c4;
            --light: #f8f9fa;
            --white: #ffffff;
            --success: #00d395;
            --warning: #ffc107;
            --danger: #ff4757;
            --border-radius: 12px;
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 82, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 211, 149, 0.1) 0%, transparent 20%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            padding: 25px 0;
            border-bottom: 1px solid var(--gray-dark);
            background-color: rgba(10, 11, 13, 0.9);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            color: var(--white);
            display: flex;
            align-items: center;
        }
        
        .logo span {
            color: var(--primary);
        }
        
        .logo svg {
            margin-right: 12px;
        }
        
        .last-updated {
            font-size: 14px;
            color: var(--gray-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .last-updated .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        main {
            padding: 40px 0;
        }
        
        .hero {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .hero h1 {
            font-size: 36px;
            margin-bottom: 15px;
            background: linear-gradient(90deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero p {
            font-size: 18px;
            color: var(--gray-light);
            max-width: 600px;
            margin: 0 auto 30px;
        }
        
        .features {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .feature-badge {
            background-color: var(--primary-light);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .converter-card {
            background-color: var(--gray-dark);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .card-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--primary);
        }
        
        .converter-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .input-group label {
            font-size: 14px;
            color: var(--gray-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .input-row {
            display: flex;
            gap: 15px;
        }
        
        .amount-input, .currency-select, .country-select, .search-input {
            flex: 1;
            padding: 15px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray);
            background-color: var(--dark);
            color: var(--light);
            font-size: 16px;
            transition: var(--transition);
        }
        
        .search-input {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%235d6785' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cpath d='m21 21-4.3-4.3'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 15px center;
            background-size: 16px;
            padding-left: 45px;
        }
        
        .amount-input:focus, .currency-select:focus, .country-select:focus, .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 82, 255, 0.2);
        }
        
        .swap-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 15px 20px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .swap-button:hover {
            background-color: #0041cc;
            transform: translateY(-2px);
        }
        
        .results-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .result-card {
            background-color: var(--dark);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 1px solid var(--gray);
            transition: var(--transition);
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .result-title {
            font-size: 14px;
            color: var(--gray-light);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .result-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 5px;
        }
        
        .result-subtitle {
            font-size: 14px;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .country-selector {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--gray);
        }
        
        .country-selector h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .popular-currencies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .currency-flag {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            background-color: var(--dark);
            border-radius: 20px;
            border: 1px solid var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .currency-flag:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .currency-flag.active {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .currency-flag img {
            width: 20px;
            height: 15px;
            border-radius: 2px;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 40px;
        }
        
        .info-card {
            background-color: var(--gray-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .info-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-card p {
            color: var(--gray-light);
            margin-bottom: 15px;
        }
        
        .crypto-list {
            list-style: none;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .crypto-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .crypto-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px 10px;
        }
        
        .crypto-item:last-child {
            border-bottom: none;
        }
        
        .crypto-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .crypto-price {
            font-weight: 600;
            text-align: right;
        }
        
        .price-change {
            font-size: 14px;
            padding: 3px 8px;
            border-radius: 4px;
            display: block;
            margin-top: 5px;
        }
        
        .positive {
            background-color: rgba(0, 211, 149, 0.2);
            color: var(--success);
        }
        
        .negative {
            background-color: rgba(255, 71, 87, 0.2);
            color: var(--danger);
        }
        
        footer {
            padding: 40px 0;
            border-top: 1px solid var(--gray-dark);
            text-align: center;
            color: var(--gray);
            font-size: 14px;
            margin-top: 40px;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--gray-light);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-links a:hover {
            color: var(--primary);
        }
        
        @media (max-width: 768px) {
            .input-row {
                flex-direction: column;
            }
            
            .results-container {
                grid-template-columns: 1fr;
            }
            
            .popular-currencies {
                justify-content: center;
            }
            
            .info-section {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .hero h1 {
                font-size: 28px;
            }
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: var(--light);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid var(--gray);
            font-size: 14px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .help-icon {
            color: var(--gray-light);
            cursor: pointer;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: var(--gray-light);
        }
        
        .loading i {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .crypto-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .dropdown {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--dark);
            min-width: 100%;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray);
        }
        
        .dropdown-content.show {
            display: block;
        }
        
        .dropdown-item {
            color: var(--light);
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .dropdown-item:hover {
            background-color: var(--gray-dark);
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background-color: var(--dark);
            padding: 10px 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            border: 1px solid var(--gray);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--white);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--gray-light);
        }
        
        .crypto-select-wrapper {
            position: relative;
        }
        
        .crypto-select {
            width: 100%;
            padding: 15px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray);
            background-color: var(--dark);
            color: var(--light);
            font-size: 16px;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%235d6785' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px;
            padding-right: 45px;
        }
        
        .crypto-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 82, 255, 0.2);
        }
        
        .crypto-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
        }
        
        .error-message {
            color: var(--danger);
            font-size: 14px;
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .retry-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: var(--transition);
        }
        
        .retry-button:hover {
            background-color: #0041cc;
        }
        
        /* NEW STYLES FOR IMPROVED SEARCH */
        .enhanced-search-container {
            position: relative;
        }
        
        .enhanced-search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--dark);
            border: 1px solid var(--gray);
            border-top: none;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .enhanced-search-results.show {
            display: block;
        }
        
        .enhanced-search-item {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .enhanced-search-item:last-child {
            border-bottom: none;
        }
        
        .enhanced-search-item:hover {
            background-color: var(--gray-dark);
        }
        
        .enhanced-search-item img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
        
        .enhanced-search-item .crypto-info {
            flex: 1;
        }
        
        .enhanced-search-item .crypto-name {
            font-weight: 600;
            font-size: 14px;
        }
        
        .enhanced-search-item .crypto-symbol {
            font-size: 12px;
            color: var(--gray-light);
        }
        
        .enhanced-search-item .crypto-price {
            font-size: 12px;
            text-align: right;
        }
        
        .no-results {
            padding: 15px;
            text-align: center;
            color: var(--gray-light);
            font-style: italic;
        }
        
        .search-info {
            font-size: 12px;
            color: var(--gray-light);
            margin-top: 5px;
        }
        
        /* NEW: Selected crypto display */
        .selected-crypto-display {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 10px;
            background-color: rgba(0, 82, 255, 0.1);
            border-radius: var(--border-radius);
            border: 1px solid var(--primary);
        }
        
        .selected-crypto-display img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
        
        .selected-crypto-display .crypto-name {
            font-weight: 600;
        }
        
        .selected-crypto-display .crypto-symbol {
            color: var(--gray-light);
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-coins"></i>
                    Live<span>Crypto</span> Converter
                </div>
                <div class="last-updated">
                    <div class="dot"></div>
                    <span id="update-time">Loading live prices...</span>
                </div>
            </div>
        </header>
        <main>
            <div class="hero">
                <h1>Live Cryptocurrency Converter</h1>
                <p>Convert any cryptocurrency with real-time global market prices. Updated every 30 seconds.</p>
                
                <div class="features">
                    <div class="feature-badge">
                        <i class="fas fa-coins"></i>
                        2000+ Crypto Coins
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-chart-line"></i>
                        Live INR & USD Prices
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-bolt"></i>
                        Instant Calculation
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-database"></i>
                        CoinGecko API
                    </div>
                </div>
            </div>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="total-cryptos">2000+</div>
                    <div class="stat-label">Cryptocurrencies</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="btc-price">Loading...</div>
                    <div class="stat-label">Bitcoin Price</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="eth-price">Loading...</div>
                    <div class="stat-label">Ethereum Price</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="market-cap">Loading...</div>
                    <div class="stat-label">Total Market Cap</div>
                </div>
            </div>
            
            <div class="converter-card">
                <h2 class="card-title">
                    <i class="fas fa-exchange-alt"></i>
                    Currency Converter
                </h2>
                
                <div class="converter-form">
                    <div class="input-group">
                        <label for="amount">
                            <i class="fas fa-money-bill-wave"></i>
                            Amount
                        </label>
                        <input type="number" id="amount" class="amount-input" placeholder="Enter amount" value="1" min="0" step="0.001">
                    </div>
                    
                    <div class="input-row">
                        <div class="input-group">
                            <label for="from-currency">
                                <i class="fas fa-arrow-down"></i>
                                From Cryptocurrency
                            </label>
                            <div class="crypto-select-wrapper">
                                <select id="from-currency" class="crypto-select">
                                    <option value="bitcoin">Bitcoin (BTC)</option>
                                    <option value="ethereum">Ethereum (ETH)</option>
                                    <option value="tether">Tether (USDT)</option>
                                    <option value="binancecoin">Binance Coin (BNB)</option>
                                    <option value="ripple">Ripple (XRP)</option>
                                    <option value="cardano">Cardano (ADA)</option>
                                    <option value="solana">Solana (SOL)</option>
                                    <option value="dogecoin">Dogecoin (DOGE)</option>
                                </select>
                            </div>
                            
                            <!-- NEW: Display selected crypto from search -->
                            <div id="selected-crypto-display" class="selected-crypto-display" style="display: none;">
                                <img id="selected-crypto-image" src="" alt="">
                                <div>
                                    <div id="selected-crypto-name" class="crypto-name"></div>
                                    <div id="selected-crypto-symbol" class="crypto-symbol"></div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="swap-button" id="swap-button">
                            <i class="fas fa-sync-alt"></i>
                            Swap
                        </button>
                        
                        <div class="input-group">
                            <label for="to-currency">
                                <i class="fas fa-arrow-up"></i>
                                To Currency
                            </label>
                            <select id="to-currency" class="currency-select">
                                <option value="inr" selected>Indian Rupee (INR)</option>
                                <option value="usd">US Dollar (USD)</option>
                                <option value="eur">Euro (EUR)</option>
                                <option value="gbp">British Pound (GBP)</option>
                                <option value="jpy">Japanese Yen (JPY)</option>
                                <option value="aud">Australian Dollar (AUD)</option>
                                <option value="cad">Canadian Dollar (CAD)</option>
                                <option value="chf">Swiss Franc (CHF)</option>
                                <option value="cny">Chinese Yuan (CNY)</option>
                                <option value="sgd">Singapore Dollar (SGD)</option>
                                <option value="hkd">Hong Kong Dollar (HKD)</option>
                                <option value="krw">South Korean Won (KRW)</option>
                                <option value="brl">Brazilian Real (BRL)</option>
                                <option value="rub">Russian Ruble (RUB)</option>
                                <option value="try">Turkish Lira (TRY)</option>
                                <option value="zar">South African Rand (ZAR)</option>
                                <option value="mxn">Mexican Peso (MXN)</option>
                                <option value="aed">UAE Dirham (AED)</option>
                                <option value="sar">Saudi Riyal (SAR)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="enhanced-search-crypto">
                            <i class="fas fa-search"></i>
                            Search 2000+ Cryptocurrencies
                        </label>
                        <div class="enhanced-search-container">
                            <input type="text" id="enhanced-search-crypto" class="search-input" placeholder="Type to search 2000+ cryptocurrencies..." autocomplete="off">
                            <div class="search-info">Search by name or symbol (e.g., "Bitcoin" or "BTC")</div>
                            <div id="enhanced-search-results" class="enhanced-search-results"></div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="country">
                            <i class="fas fa-globe"></i>
                            Select Your Country
                        </label>
                        <select id="country" class="country-select">
                            <option value="in">India</option>
                            <option value="us">United States</option>
                            <option value="gb">United Kingdom</option>
                            <option value="de">Germany</option>
                            <option value="jp">Japan</option>
                            <option value="au">Australia</option>
                            <option value="ca">Canada</option>
                            <option value="fr">France</option>
                            <option value="br">Brazil</option>
                            <option value="sg">Singapore</option>
                            <option value="kr">South Korea</option>
                            <option value="ru">Russia</option>
                            <option value="tr">Turkey</option>
                            <option value="za">South Africa</option>
                            <option value="mx">Mexico</option>
                            <option value="ae">UAE</option>
                            <option value="sa">Saudi Arabia</option>
                            <option value="ch">Switzerland</option>
                            <option value="hk">Hong Kong</option>
                            <option value="cn">China</option>
                        </select>
                    </div>
                </div>
                
                <div class="results-container">
                    <div class="result-card">
                        <div class="result-title">
                            <i class="fas fa-rupee-sign"></i>
                            Local Currency Value
                        </div>
                        <div class="result-value" id="local-value">Loading...</div>
                        <div class="result-subtitle" id="local-currency">Indian Rupee</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">
                            <i class="fas fa-dollar-sign"></i>
                            USDT Value
                        </div>
                        <div class="result-value" id="usdt-value">Loading...</div>
                        <div class="result-subtitle">Tether (Stablecoin)</div>
                    </div>
                </div>
                
                <div class="country-selector">
                    <h3>
                        <i class="fas fa-flag"></i>
                        Popular Currencies
                    </h3>
                    <div class="popular-currencies">
                        <div class="currency-flag active" data-currency="inr">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzIDIiPjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmYiLz48cmVjdCB5PSIuNjciIHdpZHRoPSIzIiBoZWlnaHQ9Ii42NyIgZmlsbD0iIzEzODgwMyIvPjxyZWN0IHk9IjEuMzMiIHdpZHRoPSIzIiBoZWlnaHQ9Ii42NyIgZmlsbD0iIzEzODgwMyIvPjxnIGZpbGw9IiNmZmYiPjxjaXJjbGUgY3g9IjEuNSIgY3k9IjEiIHI9Ii4zMyIvPjxjaXJjbGUgY3g9IjEuNSIgY3k9IjEiIHI9Ii4yNSIgZmlsbD0iIzAwODAiLz48L2c+PC9zdmc+" alt="India">
                            <span>INR</span>
                        </div>
                        <div class="currency-flag" data-currency="usd">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzIDIiPjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNMCAwaDMuMzN2LjMzSDB6bTAgLjY3aDMuMzN2LjMzSDB6bTAgLjY3aDMuMzN2LjMzSDB6bTAgLjY3aDMuMzN2LjMzSDB6IiBmaWxsPSIjYmYwYTI2Ii8+PHJlY3QgeD0iMS42NyIgd2lkdGg9IjEuNjciIGhlaWdodD0iMiIgZmlsbD0iIzAwMjQ4MSIvPjxwYXRoIGQ9Ik0xLjY3IDBoMS42N3YuMzNIMS42N3ptMCAuNjdoMS42N3YuMzNIMS42N3ptMCAuNjdoMS42N3YuMzNIMS42N3ptMCAuNjdoMS42N3YuMzNIMS42N3oiIGZpbGw9IiNmZmYiLz48L3N2Zz4=" alt="USA">
                            <span>USD</span>
                        </div>
                        <div class="currency-flag" data-currency="eur">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzIDIiPjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjIiIGZpbGw9IiMwMDMzOTgiLz48cGF0aCBkPSJNMS41IDBjLjgyIDAgMS41LjY4IDEuNSAxLjVzLS42OCAxLjUtMS41IDEuNUgwVjB6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTEuNS4zM0MuNzQuMzMuMzMuNzQuMzMgMS41Uy43NCAyLjY3IDEuNSAyLjY3IDEuNS4zMyAxLjUuMzN6IiBmaWxsPSIjZmZjZDAwIi8+PC9zdmc+" alt="EU">
                            <span>EUR</span>
                        </div>
                        <div class="currency-flag" data-currency="gbp">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzIDIiPjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjIiIGZpbGw9IiMwMDJGNzciLz48cGF0aCBkPSJNMCAwaDEuNXYySDB6bTEuNSAwaDEuNXYySDEuNXoiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNMCAwaDMuMzN2LjY3SDB6bTAgMS4zM2gzLjMzdjEuMzNIMHoiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNMCAwaDMuMzN2LjY3SDB6bTAgMS4zM2gzLjMzdjEuMzNIMHoiIGZpbGw9IiNjODExMkIiLz48cGF0aCBkPSJNMS42NyAwaDEuNnYySDEuNjd6TTAgMWgzLjMzdjEuMzNIMHoiIGZpbGw9IiNjODExMkIiLz48L3N2Zz4=" alt="UK">
                            <span>GBP</span>
                        </div>
                        <div class="currency-flag" data-currency="jpy">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzIDIiPjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmYiLz48Y2lyY2xlIGN4PSIxLjUiIGN5PSIxIiByPSIuNjciIGZpbGw9IiNiYzAwMjYiLz48L3N2Zz4=" alt="Japan">
                            <span>JPY</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="info-section">
                <div class="info-card">
                    <h3><i class="fas fa-chart-line"></i> Live Crypto Prices</h3>
                    <p>Real-time cryptocurrency prices from global markets</p>
                    <div class="loading" id="loading-prices">
                        <i class="fas fa-spinner"></i> Loading live prices...
                    </div>
                    <ul class="crypto-list" id="crypto-prices">
                        <!-- Crypto prices will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-lightbulb"></i> How to Use</h3>
                    <p><strong>Step 1:</strong> Enter the amount of cryptocurrency you want to convert.</p>
                    <p><strong>Step 2:</strong> Select from 2000+ cryptocurrencies using the dropdown or search.</p>
                    <p><strong>Step 3:</strong> Select your country or desired currency.</p>
                    <p><strong>Step 4:</strong> View the converted amount in both local currency and USDT.</p>
                    <p><strong>Tip:</strong> Prices update automatically every 30 seconds using CoinGecko API.</p>
                </div>
            </div>
        </main>
        <footer>
            <div class="footer-content">
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">About Us</a>
                    <a href="#">Contact</a>
                    <a href="#">API</a>
                </div>
                <p>Â© 2024 Live Crypto Converter. All rights reserved.</p>
                <p><i class="fas fa-exclamation-circle"></i> Prices are updated in real-time from CoinGecko API. Cryptocurrency investments are subject to market risk.</p>
            </div>
        </footer>
    </div>

    <script>
        // DOM elements
        const amountInput = document.getElementById('amount');
        const fromCurrencySelect = document.getElementById('from-currency');
        const toCurrencySelect = document.getElementById('to-currency');
        const swapButton = document.getElementById('swap-button');
        const countrySelect = document.getElementById('country');
        const enhancedSearchInput = document.getElementById('enhanced-search-crypto');
        const enhancedSearchResults = document.getElementById('enhanced-search-results');
        const localValueElement = document.getElementById('local-value');
        const usdtValueElement = document.getElementById('usdt-value');
        const localCurrencyElement = document.getElementById('local-currency');
        const updateTimeElement = document.getElementById('update-time');
        const currencyFlags = document.querySelectorAll('.currency-flag');
        const cryptoPricesList = document.getElementById('crypto-prices');
        const loadingPrices = document.getElementById('loading-prices');
        const totalCryptosElement = document.getElementById('total-cryptos');
        const btcPriceElement = document.getElementById('btc-price');
        const ethPriceElement = document.getElementById('eth-price');
        const marketCapElement = document.getElementById('market-cap');
        
        // NEW: Selected crypto display elements
        const selectedCryptoDisplay = document.getElementById('selected-crypto-display');
        const selectedCryptoImage = document.getElementById('selected-crypto-image');
        const selectedCryptoName = document.getElementById('selected-crypto-name');
        const selectedCryptoSymbol = document.getElementById('selected-crypto-symbol');
        
        // Store current prices and crypto list
        let currentPrices = {};
        let cryptoList = [];
        let usdtPrice = 1;
        let allCryptos = []; // Store all 2000+ cryptocurrencies
        let selectedCryptoFromSearch = null; // Track crypto selected from search
        
        // Country to currency mapping
        const countryCurrencyMap = {
            in: 'inr', us: 'usd', gb: 'gbp', de: 'eur', jp: 'jpy',
            au: 'aud', ca: 'cad', fr: 'eur', br: 'brl', sg: 'sgd',
            kr: 'krw', ru: 'rub', tr: 'try', za: 'zar', mx: 'mxn',
            ae: 'aed', sa: 'sar', ch: 'chf', hk: 'hkd', cn: 'cny'
        };
        
        // Popular cryptocurrencies for display
        const popularCryptos = [
            'bitcoin', 'ethereum', 'tether', 'binancecoin', 'ripple',
            'cardano', 'solana', 'dogecoin', 'polkadot', 'litecoin',
            'chainlink', 'stellar', 'uniswap', 'avalanche-2', 'polygon'
        ];
        
        // NEW: Fetch all cryptocurrencies from CoinGecko API
        async function fetchAllCryptos() {
            try {
                // Fetch all cryptocurrencies (limit to 2000)
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=2000&page=1&sparkline=false');
                
                if (!response.ok) {
                    throw new Error('Failed to fetch crypto list');
                }
                
                const data = await response.json();
                allCryptos = data;
                
                // Update total crypto count
                totalCryptosElement.textContent = `${data.length}+`;
                
                // Populate the from currency dropdown with more options
                populateFromCurrencyDropdown();
                
            } catch (error) {
                console.error('Error fetching crypto list:', error);
                // Use a fallback list if API fails
                allCryptos = [
                    { id: 'bitcoin', symbol: 'btc', name: 'Bitcoin', image: 'https://assets.coingecko.com/coins/images/1/small/bitcoin.png' },
                    { id: 'ethereum', symbol: 'eth', name: 'Ethereum', image: 'https://assets.coingecko.com/coins/images/279/small/ethereum.png' },
                    { id: 'tether', symbol: 'usdt', name: 'Tether', image: 'https://assets.coingecko.com/coins/images/325/small/Tether.png' },
                    { id: 'binancecoin', symbol: 'bnb', name: 'BNB', image: 'https://assets.coingecko.com/coins/images/825/small/bnb-icon2_2x.png' },
                    { id: 'ripple', symbol: 'xrp', name: 'XRP', image: 'https://assets.coingecko.com/coins/images/44/small/xrp-symbol-white-128.png' },
                    { id: 'cardano', symbol: 'ada', name: 'Cardano', image: 'https://assets.coingecko.com/coins/images/975/small/cardano.png' },
                    { id: 'solana', symbol: 'sol', name: 'Solana', image: 'https://assets.coingecko.com/coins/images/4128/small/solana.png' },
                    { id: 'dogecoin', symbol: 'doge', name: 'Dogecoin', image: 'https://assets.coingecko.com/coins/images/5/small/dogecoin.png' }
                ];
                totalCryptosElement.textContent = '2000+';
                populateFromCurrencyDropdown();
            }
        }
        
        // Populate the from currency dropdown with crypto options
        function populateFromCurrencyDropdown() {
            // Clear existing options except the first few popular ones
            while (fromCurrencySelect.options.length > 8) {
                fromCurrencySelect.remove(8);
            }
            
            // Add more cryptocurrencies to the dropdown
            allCryptos.slice(0, 50).forEach(crypto => {
                // Skip if already exists
                if (Array.from(fromCurrencySelect.options).some(opt => opt.value === crypto.id)) {
                    return;
                }
                
                const option = document.createElement('option');
                option.value = crypto.id;
                option.textContent = `${crypto.name} (${crypto.symbol.toUpperCase()})`;
                fromCurrencySelect.appendChild(option);
            });
        }
        
        // NEW: Enhanced search functionality for 2000+ cryptocurrencies
        function performEnhancedSearch(searchTerm) {
            enhancedSearchResults.innerHTML = '';
            
            if (searchTerm.length < 2) {
                enhancedSearchResults.classList.remove('show');
                return;
            }
            
            const filteredCryptos = allCryptos.filter(crypto => 
                crypto.name.toLowerCase().includes(searchTerm) || 
                crypto.symbol.toLowerCase().includes(searchTerm)
            ).slice(0, 10); // Limit to 10 results
            
            if (filteredCryptos.length > 0) {
                filteredCryptos.forEach(crypto => {
                    const item = document.createElement('div');
                    item.className = 'enhanced-search-item';
                    
                    // Check if we have current price data for this crypto
                    const currentPrice = currentPrices[crypto.id]?.usd;
                    const priceText = currentPrice ? 
                        `$${currentPrice.toLocaleString('en-US', { maximumFractionDigits: 4 })}` : 
                        'Price loading...';
                    
                    item.innerHTML = `
                        <img src="${crypto.image}" alt="${crypto.name}" class="crypto-icon">
                        <div class="crypto-info">
                            <div class="crypto-name">${crypto.name}</div>
                            <div class="crypto-symbol">${crypto.symbol.toUpperCase()}</div>
                        </div>
                        <div class="crypto-price">${priceText}</div>
                    `;
                    
                    item.onclick = () => {
                        // NEW: Set the selected crypto from search
                        selectCryptoFromSearch(crypto);
                        enhancedSearchInput.value = crypto.name;
                        enhancedSearchResults.classList.remove('show');
                    };
                    
                    enhancedSearchResults.appendChild(item);
                });
                enhancedSearchResults.classList.add('show');
            } else {
                const noResults = document.createElement('div');
                noResults.className = 'no-results';
                noResults.textContent = 'No cryptocurrencies found. Try a different search term.';
                enhancedSearchResults.appendChild(noResults);
                enhancedSearchResults.classList.add('show');
            }
        }
        
        // NEW: Function to handle crypto selection from search
        function selectCryptoFromSearch(crypto) {
            selectedCryptoFromSearch = crypto;
            
            // Update the display
            selectedCryptoImage.src = crypto.image;
            selectedCryptoImage.alt = crypto.name;
            selectedCryptoName.textContent = crypto.name;
            selectedCryptoSymbol.textContent = crypto.symbol.toUpperCase();
            
            // Show the selected crypto display
            selectedCryptoDisplay.style.display = 'flex';
            
            // Hide the dropdown
            fromCurrencySelect.style.display = 'none';
            
            // Calculate conversion immediately
            calculateConversion();
        }
        
        // NEW: Function to reset to dropdown selection
        function resetToDropdownSelection() {
            selectedCryptoFromSearch = null;
            selectedCryptoDisplay.style.display = 'none';
            fromCurrencySelect.style.display = 'block';
            calculateConversion();
        }
        
        // Fetch live prices from CoinGecko API - IMPROVED VERSION
        async function fetchLivePrices() {
            try {
                loadingPrices.style.display = 'block';
                
                // Get IDs of popular cryptos for the API call
                const cryptoIds = popularCryptos.join(',');
                
                const response = await fetch(
                    `https://api.coingecko.com/api/v3/simple/price?ids=${cryptoIds}&vs_currencies=inr,usd,eur,gbp,jpy,aud,cad,chf,cny,sgd,hkd,krw,brl,rub,try,zar,mxn,aed,sar&include_24hr_change=true&include_market_cap=true`
                );
                
                if (!response.ok) {
                    throw new Error('Failed to fetch prices');
                }
                
                const data = await response.json();
                currentPrices = data;
                
                // Update USDT price
                if (data.tether && data.tether.usd) {
                    usdtPrice = data.tether.usd;
                }
                
                // Update time
                const now = new Date();
                updateTimeElement.textContent = `Last updated: ${now.toLocaleTimeString()}`;
                
                // Update converter
                calculateConversion();
                
                // Update crypto list
                displayCryptoPrices();
                
                // Update stats
                updateStats();
                
            } catch (error) {
                console.error('Error fetching prices:', error);
                updateTimeElement.textContent = 'Failed to update prices';
                updateTimeElement.style.color = 'var(--danger)';
                
                // Fallback to mock data if API fails
                useMockData();
            }
        }
        
        // Update stats bar
        function updateStats() {
            if (currentPrices.bitcoin) {
                btcPriceElement.textContent = `$${currentPrices.bitcoin.usd.toLocaleString('en-US', { maximumFractionDigits: 0 })}`;
            }
            
            if (currentPrices.ethereum) {
                ethPriceElement.textContent = `$${currentPrices.ethereum.usd.toLocaleString('en-US', { maximumFractionDigits: 0 })}`;
            }
            
            // Calculate total market cap (simplified - just sum of top 15)
            let totalMarketCap = 0;
            popularCryptos.forEach(crypto => {
                if (currentPrices[crypto] && currentPrices[crypto].usd_market_cap) {
                    totalMarketCap += currentPrices[crypto].usd_market_cap;
                }
            });
            
            if (totalMarketCap > 0) {
                marketCapElement.textContent = `$${(totalMarketCap / 1000000000).toFixed(1)}B`;
            }
        }
        
        // Fallback mock data in case API fails
        function useMockData() {
            currentPrices = {
                bitcoin: { usd: 45000, inr: 3750000, eur: 41000, gbp: 35000, usd_24h_change: 2.5, usd_market_cap: 880000000000 },
                ethereum: { usd: 3000, inr: 250000, eur: 2750, gbp: 2350, usd_24h_change: 1.8, usd_market_cap: 360000000000 },
                tether: { usd: 1, inr: 83.3, eur: 0.92, gbp: 0.78, usd_24h_change: 0, usd_market_cap: 83000000000 },
                binancecoin: { usd: 350, inr: 29000, eur: 320, gbp: 275, usd_24h_change: -0.5, usd_market_cap: 54000000000 },
                ripple: { usd: 0.6, inr: 50, eur: 0.55, gbp: 0.47, usd_24h_change: 0.3, usd_market_cap: 32000000000 },
                cardano: { usd: 0.45, inr: 37.5, eur: 0.41, gbp: 0.35, usd_24h_change: -1.2, usd_market_cap: 16000000000 },
                solana: { usd: 100, inr: 8300, eur: 91, gbp: 78, usd_24h_change: 5.2, usd_market_cap: 41000000000 },
                dogecoin: { usd: 0.08, inr: 6.65, eur: 0.073, gbp: 0.062, usd_24h_change: -2.1, usd_market_cap: 11000000000 }
            };
            
            const now = new Date();
            updateTimeElement.textContent = `Last updated: ${now.toLocaleTimeString()} (Mock Data)`;
            updateTimeElement.style.color = 'var(--warning)';
            
            calculateConversion();
            displayCryptoPrices();
            updateStats();
        }
        
        // Calculate and display conversion - IMPROVED VERSION
        function calculateConversion() {
            const amount = parseFloat(amountInput.value) || 0;
            const toCurrency = toCurrencySelect.value;
            
            // Determine which crypto to use
            let fromCurrency;
            if (selectedCryptoFromSearch) {
                fromCurrency = selectedCryptoFromSearch.id;
            } else {
                fromCurrency = fromCurrencySelect.value;
            }
            
            // If we don't have the price for the selected cryptocurrency, fetch it
            if (!currentPrices[fromCurrency] || !currentPrices[fromCurrency][toCurrency]) {
                fetchPriceForSelectedCrypto(fromCurrency, toCurrency);
                return;
            }
            
            updateConversionDisplay(amount, fromCurrency, toCurrency);
        }
        
        // Fetch price for selected cryptocurrency - NEW FUNCTION
        async function fetchPriceForSelectedCrypto(cryptoId, currency) {
            try {
                // Show loading state
                localValueElement.textContent = 'Loading...';
                usdtValueElement.textContent = 'Loading...';
                
                // Fetch price for this specific crypto
                const response = await fetch(
                    `https://api.coingecko.com/api/v3/simple/price?ids=${cryptoId}&vs_currencies=${currency},usd&include_24hr_change=false`
                );
                
                if (!response.ok) {
                    throw new Error('Failed to fetch price');
                }
                
                const data = await response.json();
                
                if (data[cryptoId]) {
                    // Update current prices with the new data
                    if (!currentPrices[cryptoId]) {
                        currentPrices[cryptoId] = {};
                    }
                    
                    // Update both the target currency and USD prices
                    Object.keys(data[cryptoId]).forEach(key => {
                        currentPrices[cryptoId][key] = data[cryptoId][key];
                    });
                    
                    // Recalculate conversion
                    const amount = parseFloat(amountInput.value) || 0;
                    updateConversionDisplay(amount, cryptoId, currency);
                } else {
                    throw new Error('Price not available');
                }
                
            } catch (error) {
                console.error(`Error fetching price for ${cryptoId}:`, error);
                localValueElement.textContent = 'Price not available';
                usdtValueElement.textContent = 'Price not available';
                
                // Add retry button
                const retryButton = document.createElement('button');
                retryButton.className = 'retry-button';
                retryButton.innerHTML = '<i class="fas fa-redo"></i> Retry';
                retryButton.onclick = () => fetchPriceForSelectedCrypto(cryptoId, currency);
                
                // Remove existing retry button if any
                const existingRetry = document.querySelector('.retry-button');
                if (existingRetry) {
                    existingRetry.remove();
                }
                
                usdtValueElement.parentNode.appendChild(retryButton);
            }
        }
        
        // Update the conversion display - IMPROVED VERSION
        function updateConversionDisplay(amount, fromCurrency, toCurrency) {
            // Get the rate for the selected currencies
            const fromRate = currentPrices[fromCurrency]?.[toCurrency];
            const usdRate = currentPrices[fromCurrency]?.usd;
            
            // Format and display values
            const currencySymbols = {
                inr: 'â¹', usd: '$', eur: 'â¬', gbp: 'Â£', jpy: 'Â¥',
                aud: 'A$', cad: 'C$', chf: 'CHF', cny: 'Â¥', sgd: 'S$',
                hkd: 'HK$', krw: 'â©', brl: 'R$', rub: 'â½', try: 'âº',
                zar: 'R', mxn: 'MX$', aed: 'AED', sar: 'SAR'
            };
            
            const symbol = currencySymbols[toCurrency] || '';
            
            // Format the local value
            if (fromRate && !isNaN(fromRate)) {
                const convertedValue = amount * fromRate;
                localValueElement.textContent = `${symbol} ${convertedValue.toLocaleString('en-IN', { 
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 6 
                })}`;
            } else {
                localValueElement.textContent = 'Price not available';
            }
            
            // Format the USDT value - FIXED CALCULATION
            if (usdRate && !isNaN(usdRate)) {
                let usdtValue;
                
                if (fromCurrency === 'tether') {
                    // If converting from USDT, the value is the same as the amount
                    usdtValue = amount;
                } else {
                    // Convert to USD first, then to USDT
                    usdtValue = amount * usdRate / usdtPrice;
                }
                
                usdtValueElement.textContent = `${usdtValue.toLocaleString('en-IN', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 6
                })} USDT`;
            } else {
                usdtValueElement.textContent = 'Price not available';
            }
            
            localCurrencyElement.textContent = toCurrency.toUpperCase();
            
            // Remove any existing retry buttons
            const existingRetry = document.querySelector('.retry-button');
            if (existingRetry) {
                existingRetry.remove();
            }
        }
        
        // Display crypto prices
        function displayCryptoPrices() {
            cryptoPricesList.innerHTML = '';
            loadingPrices.style.display = 'none';
            
            popularCryptos.forEach(cryptoId => {
                if (currentPrices[cryptoId]) {
                    const crypto = currentPrices[cryptoId];
                    const listItem = document.createElement('li');
                    listItem.className = 'crypto-item';
                    listItem.onclick = () => {
                        // Reset to dropdown selection when clicking on popular crypto
                        resetToDropdownSelection();
                        fromCurrencySelect.value = cryptoId;
                        calculateConversion();
                    };
                    
                    const change = crypto.usd_24h_change || 0;
                    const changeClass = change >= 0 ? 'positive' : 'negative';
                    const changeSymbol = change >= 0 ? '+' : '';
                    
                    listItem.innerHTML = `
                        <div class="crypto-name">
                            <i class="fab fa-${cryptoId === 'bitcoin' ? 'bitcoin' : cryptoId === 'ethereum' ? 'ethereum' : 'coins'}"></i>
                            <span>${cryptoId.charAt(0).toUpperCase() + cryptoId.slice(1)}</span>
                        </div>
                        <div class="crypto-price">
                            $${crypto.usd.toLocaleString('en-US', { maximumFractionDigits: 2 })}
                            <span class="price-change ${changeClass}">${changeSymbol}${change?.toFixed(2) || '0.00'}%</span>
                        </div>
                    `;
                    
                    cryptoPricesList.appendChild(listItem);
                }
            });
        }
        
        // Swap currencies function
        function swapCurrencies() {
            // If we have a selected crypto from search, reset to dropdown
            if (selectedCryptoFromSearch) {
                resetToDropdownSelection();
            }
            
            const temp = fromCurrencySelect.value;
            fromCurrencySelect.value = toCurrencySelect.value;
            
            // If swapping to a fiat currency, set to USDT
            if (countryCurrencyMap[Object.keys(countryCurrencyMap).find(key => countryCurrencyMap[key] === temp)]) {
                toCurrencySelect.value = 'tether';
            } else {
                toCurrencySelect.value = temp;
            }
            
            calculateConversion();
        }
        
        // Event listeners
        amountInput.addEventListener('input', calculateConversion);
        fromCurrencySelect.addEventListener('change', () => {
            // Reset to dropdown selection when changing dropdown
            resetToDropdownSelection();
            calculateConversion();
        });
        toCurrencySelect.addEventListener('change', calculateConversion);
        swapButton.addEventListener('click', swapCurrencies);
        countrySelect.addEventListener('change', () => {
            const selectedCountry = countrySelect.value;
            const mappedCurrency = countryCurrencyMap[selectedCountry];
            
            if (mappedCurrency) {
                toCurrencySelect.value = mappedCurrency;
                
                // Update active currency flag
                currencyFlags.forEach(flag => {
                    flag.classList.remove('active');
                    if (flag.dataset.currency === mappedCurrency) {
                        flag.classList.add('active');
                    }
                });
                
                calculateConversion();
            }
        });
        
        // NEW: Enhanced search event listener
        enhancedSearchInput.addEventListener('input', (e) => {
            performEnhancedSearch(e.target.value.toLowerCase());
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!enhancedSearchInput.contains(e.target) && !enhancedSearchResults.contains(e.target)) {
                enhancedSearchResults.classList.remove('show');
            }
        });
        
        // Add event listeners to currency flags
        currencyFlags.forEach(flag => {
            flag.addEventListener('click', () => {
                const currency = flag.dataset.currency;
                toCurrencySelect.value = currency;
                
                // Update active state
                currencyFlags.forEach(f => f.classList.remove('active'));
                flag.classList.add('active');
                
                calculateConversion();
            });
        });
        
        // NEW: Add click listener to selected crypto display to reset
        selectedCryptoDisplay.addEventListener('click', resetToDropdownSelection);
        
        // Initial setup
        fetchAllCryptos(); // NEW: Fetch all cryptos first
        fetchLivePrices();
        
        // Update prices every 30 seconds
        setInterval(fetchLivePrices, 30000);
    </script>
</body>
</html>